<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get abnormal mark — getAbnormalMark • lab</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Get abnormal mark — getAbnormalMark"><meta property="og:description" content="getAbnormalMark generates a new column recorded abnormal values: high H and L."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lab</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/DHLab-TSENG/lab/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get abnormal mark</h1>
    <small class="dont-index">Source: <a href="http://github.com/DHLab-TSENG/lab/blob/HEAD/R/getAbnormalMark.R" class="external-link"><code>R/getAbnormalMark.R</code></a>, <a href="http://github.com/DHLab-TSENG/lab/blob/HEAD/R/labFun.R" class="external-link"><code>R/labFun.R</code></a></small>
    <div class="hidden name"><code>abMark.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>getAbnormalMark</code> generates a new column recorded abnormal values: high <code>H</code> and <code>L</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">getAbnormalMark</span><span class="op">(</span>
  <span class="va">labData</span>,
  <span class="va">idColName</span>,
  <span class="va">labItemColName</span>,
  <span class="va">valueColName</span>,
  <span class="va">genderColName</span>,
  <span class="va">genderTable</span>,
  referenceTable <span class="op">=</span> <span class="va">refLOINC</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>labData</dt>
<dd><p>a file or dataframe of laboratory test data with at least 4 columns about patient ID, lab item, test value and test date, respectively.</p></dd>
<dt>idColName</dt>
<dd><p>the column name that records patient ID in labData.</p></dd>
<dt>labItemColName</dt>
<dd><p>the column name that records lab item in labData. If lab code is combined by multiple columns, then just simply add <code>+</code> operator between column names, e.g., <code>A + B</code>.</p></dd>
<dt>valueColName</dt>
<dd><p>the column name that records test value in labData. Only numeric value is acceptable.</p></dd>
<dt>genderColName</dt>
<dd><p>the column name that records gender of each patient. Gender should be coded as <code>M</code> or <code>F</code>.</p></dd>
<dt>referenceTable</dt>
<dd><p>a data table that records reference values of each lab item. Column names should be: <code>LowerBound_Male</code>, <code>UpperBound_Male</code>, <code>LowerBound_Female</code>, <code>UpperBound_Female</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data.table</code> merged two tables.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This step is optional but recommended. Reference ranges differ in different institutions, so a user-defined reference table is needed. The table should record the reference values for male and female separately. Lower bound can be expressed as <code>&lt;</code>, <code>(</code> (greater than) or  <code>&lt;=</code> , <code>[</code> (great tham or euqal to), and the expression of upper bound is similar. If there is no upper bound or lower bound, just remain empty. After the new abnormal flag column generated, it can be used to do categorical analysis, or be used in the function: <code>plotTimeSeriesLab</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">loincSample</span> <span class="op">&lt;-</span> <span class="fu"><a href="mapLOINC.html">mapLOINC</a></span><span class="op">(</span>labData <span class="op">=</span> <span class="va">labSample</span>,</span>
<span class="r-in">                       labItemColName <span class="op">=</span> <span class="va">ITEMID</span>,</span>
<span class="r-in">                       mappingTable <span class="op">=</span> <span class="va">mapSample</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">getAbnormalMark</span><span class="op">(</span>labData <span class="op">=</span> <span class="va">loincSample</span>,</span>
<span class="r-in">               idColName <span class="op">=</span> <span class="va">SUBJECT_ID</span>,</span>
<span class="r-in">               labItemColName <span class="op">=</span> <span class="va">LOINC</span>,</span>
<span class="r-in">               valueColName <span class="op">=</span> <span class="va">VALUENUM</span>,</span>
<span class="r-in">               genderColName <span class="op">=</span> <span class="va">GENDER</span>,</span>
<span class="r-in">               genderTable <span class="op">=</span> <span class="va">patientSample</span>,</span>
<span class="r-in">               referenceTable <span class="op">=</span> <span class="va">refLOINC</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ITEMID  ID  CHARTTIME Value VALUEUOM     FLAG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:  50861  36 2131-04-30   8.0     IU/L         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:  50861  36 2131-05-17  12.0     IU/L         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:  50861  36 2134-05-14  12.0     IU/L         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:  50861 109 2138-07-03  14.0     IU/L         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:  50861 109 2142-03-21  46.0     IU/L abnormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1740:  51222 145 2145-02-17   9.8     g/dL abnormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1741:  51222 145 2144-05-04   9.1     g/dL abnormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1742:  51222 145 2144-05-26   9.0     g/dL abnormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1743:  51222 145 2144-04-13  11.2     g/dL abnormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1744:  51222 145 2144-04-29  10.5     g/dL abnormal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                LABEL FLUID   CATEGORY  LOINC ABMark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: Alanine Aminotransferase (ALT) Blood  Chemistry 1742-6   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: Alanine Aminotransferase (ALT) Blood  Chemistry 1742-6   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: Alanine Aminotransferase (ALT) Blood  Chemistry 1742-6   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: Alanine Aminotransferase (ALT) Blood  Chemistry 1742-6   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: Alanine Aminotransferase (ALT) Blood  Chemistry 1742-6      H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1740:                     Hemoglobin Blood Hematology  718-7      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1741:                     Hemoglobin Blood Hematology  718-7      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1742:                     Hemoglobin Blood Hematology  718-7      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1743:                     Hemoglobin Blood Hematology  718-7      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1744:                     Hemoglobin Blood Hematology  718-7      L</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Use user define table</span></span>
<span class="r-in"><span class="fu">getAbnormalMark</span><span class="op">(</span>labData <span class="op">=</span> <span class="va">labSample</span>,</span>
<span class="r-in">               idColName <span class="op">=</span> <span class="va">SUBJECT_ID</span>,</span>
<span class="r-in">               labItemColName <span class="op">=</span> <span class="va">ITEMID</span>,</span>
<span class="r-in">               valueColName <span class="op">=</span> <span class="va">VALUENUM</span>,</span>
<span class="r-in">               genderColName <span class="op">=</span> <span class="va">GENDER</span>,</span>
<span class="r-in">               genderTable <span class="op">=</span> <span class="va">patientSample</span>,</span>
<span class="r-in">               referenceTable <span class="op">=</span> <span class="va">refUserDefine</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID ITEMID  CHARTTIME Value VALUEUOM     FLAG ABMark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:  36  50811 2131-05-18  12.7     g/dL abnormal   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:  36  50811 2131-05-04  12.3     g/dL abnormal   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:  36  50811 2131-05-15  10.0     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:  36  50811 2131-05-17  11.7     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 109  50811 2142-02-25   6.9     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1740: 145  51222 2145-02-17   9.8     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1741: 145  51222 2144-05-04   9.1     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1742: 145  51222 2144-05-26   9.0     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1743: 145  51222 2144-04-13  11.2     g/dL abnormal      L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1744: 145  51222 2144-04-29  10.5     g/dL abnormal      L</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Chen-Ju Chen, Yi-Ju Tseng.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

